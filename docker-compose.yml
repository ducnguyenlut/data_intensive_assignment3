# services:
#   mongodb:
#     image: mongo:8.2
#     container_name: mongodb
#     ports:
#       - "27017:27017"
#     volumes:
#       - ./database:/data/db

#   backend:
#     build: ./backend
#     container_name: backend
#     ports:
#       - "2000:2000"
#     environment:
#       - MONGO_URI=mongodb://mongodb:27017
#     depends_on:
#       - mongodb

#   frontend:
#     build: ./frontend
#     ports:
#       - "1000:1000"
#     depends_on:
#       - backend
#     environment:
#       - REACT_APP_API_URL=http://localhost:2000

# version: "3.8"

services:
  mongodb:
    image: mongo:8.2
    container_name: mongodb
    ports:
      - "27017:27017"
    volumes:
      - ./database:/data/db

  backend:
    build: ./backend
    container_name: backend
    ports:
      - "2000:2000"
    environment:
      - MONGO_URI=mongodb://mongodb:27017
      # - NODE_ENV=development
    depends_on:
      - mongodb
    # volumes:
    #   - ./backend:/app
    # command: npm start # if you're using nodemon or similar for auto-reload

  # seed:
  #   build: ./backend
  #   depends_on:
  #     - mongodb
  #   command: node seed.js
  #   volumes:
  #     - ./backend:/app

  frontend:
    build: ./frontend
    container_name: frontend
    ports:
      - "1000:1000"
    environment:
      - REACT_APP_API_URL=http://backend:2000  # ðŸ‘ˆ internal network reference
    depends_on:
      - backend
    volumes:
      - ./frontend:/app
      - /app/node_modules
    command: npm run dev -- --host  # ðŸ‘ˆ ensure Vite/React accessible from outside